"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var r,o,c,n,i,a=gap,u=t[e];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(e)),"function"==typeof rep&&(u=rep.call(t,e,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=indent,i=[],"[object Array]"===Object.prototype.toString.apply(u)){for(n=u.length,r=0;r<n;r+=1)i[r]=str(r,u)||"null";return c=0===i.length?"[]":gap?"[\n"+gap+i.join(",\n"+gap)+"\n"+a+"]":"["+i.join(",")+"]",gap=a,c}if(rep&&"object"==typeof rep)for(n=rep.length,r=0;r<n;r+=1)"string"==typeof rep[r]&&(o=rep[r],c=str(o,u),c&&i.push(quote(o)+(gap?": ":":")+c));else for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(c=str(o,u),c&&i.push(quote(o)+(gap?": ":":")+c));return c=0===i.length?"{}":gap?"{\n"+gap+i.join(",\n"+gap)+"\n"+a+"}":"{"+i.join(",")+"}",gap=a,c}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,r){var o;if(gap="",indent="","number"==typeof r)for(o=0;o<r;o+=1)indent+=" ";else"string"==typeof r&&(indent=r);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var r,o,c=e[t];if(c&&"object"==typeof c)for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(o=walk(c,r),void 0!==o?c[r]=o:delete c[r]);return reviver.call(e,t,c)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e){"use strict";function t(){return E.useTest?"staging.cquotient.com":"cquotient.com"}function r(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r+"::"+e[r]);return t.join("||")}function o(e){for(var t=[],o=0;o<e.length;o++){var c=e[o];"[object Object]"===Object.prototype.toString.call(c)?t.push(r(c)):t.push(c)}return t.join(";;")}function c(e){var t=["%23","%24","%26","%2B","%5E","%60","%7C","%2F","%3A","%3C","%3D","%3E","%3F","%40","%5B","%5D","%7B","%7D"],r=new RegExp(t.join("|"),"g"),o=encodeURIComponent(e);return o=o.replace(r,decodeURIComponent)}function n(e,t){var r=c(t.value)||"",o=c(e)+"="+r+";";t.domain&&(o+=" domain="+t.domain+";"),t.path&&(o+=" path="+t.path+";"),t.expires&&(o+=" expires="+t.expires+";"),document.cookie=o}function i(e,t,r,o){try{window.sessionStorage.setItem("cq."+t,JSON.stringify(e))}catch(t){var i=E.byteLength(c(JSON.stringify(e)));i>3072?E.sendActivity(o,"error",{time:(new Date).getTime(),error:r+"  too large"}):n(r,{value:JSON.stringify(e),path:"/"})}}function a(){return document.cookie.indexOf("__cq_dnt=1")!==-1}function u(){try{for(var e=["cqcid","cquid","__cq_uuid","__cqact","__cqviews","__cq_bc","__cq_seg","__cq_anchor"],t=(e.length,document.cookie.split(";")),r=0,o=t.length;r<o;r++){var c=t[r],n=c.indexOf("="),i=(n>-1?c.substr(0,n):c).trim();e.indexOf(i)!==-1&&(document.cookie=i+"=; path=/; domain="+F+"; expires=Thu, 01 Jan 1970 00:00:00 GMT")}}catch(e){}}function s(e){for(var t,r=window.location.search.substring(1),o=r.split("&"),c=0,n=o.length;c<n;c++){var i=o[c].split("=");if(decodeURIComponent(i[0])===e){t=decodeURIComponent(i[1]);break}}return t}function d(e){var t=[];for(var c in e)if(e.hasOwnProperty(c)){var n=e[c],i=encodeURIComponent(c)+"=";i+="[object Object]"===Object.prototype.toString.call(n)?encodeURIComponent(r(n)):"[object Array]"===Object.prototype.toString.call(n)?encodeURIComponent(o(n)):encodeURIComponent(n),t.push(i)}return t.join("&").length<1e3&&t.push("json="+encodeURIComponent(JSON.stringify(e))),t.join("&")}function p(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1").replace(/\+/g,"%20"))||null}function f(e){for(var t,r,o=[void 0],c="",i=document.location.hostname.split(".").reverse(),a=0,u=i.length;a<u;a++)c="."+i[a]+c,o.push(c);try{t=p(e)}catch(e){t=void 0}for(var s=0,d=o.length;s<d;s++){var f=o[s];n(e,{domain:f,path:"/",expires:"Thu, 01 Jan 1970 00:00:00 UTC"});try{r=p(e)}catch(e){r=void 0}if(t!==r)return n(e,{value:t,domain:f,path:"/"}),f}}function l(e){var t=f(e);n(e,{path:"/",expires:"Thu, 01 Jan 1970 00:00:00 UTC",domain:t})}function v(){var e,t;try{e=window.sessionStorage.getItem("cq.anchor")}catch(t){e=p("__cq_anchor")}try{t=JSON.parse(e)||{}}catch(e){t={}}return t}function m(e){var t,r;try{t=p("__cq_bc"),t||(t=p("bc")),t&&(t=t.replace(/^j:/,""),t=JSON.parse(t),r={},r[e]=t[e],r=JSON.stringify(r))}catch(e){}return r}function h(e,t){try{var r=window.sessionStorage.getItem("cq."+e);if(!r)return[];try{return JSON.parse(r)}catch(e){return[]}}catch(e){var o=p(t);if(!o)return[];try{return JSON.parse(o)}catch(e){return[]}}}function g(){return h("viewReco","__cqviews")}function y(){return h("viewSearch","__cqsviews")}function _(){return h("viewCategory","__cqcviews")}function w(e,t){var r=L[t.recommenderName]=L[t.recommenderName]||[];r.push(t.products),clearTimeout(V[t.recommenderName]),V[t.recommenderName]=window.setTimeout(function(){for(var o=[],c=0;c<r.length;c++)o=o.concat(r[c]);t.products=o,E.sendActivity(e,"viewReco",t);var n=g();n.push({recommenderName:t.recommenderName,cookieId:t.cookieId,userId:t.userId,products:t.products}),i(n,"viewReco","__cqviews",e)},0)}function I(e,t){var r=Q[t.searchText]=Q[t.searchText]||[];r.push(t.products),clearTimeout($[t.searchText]),$[t.searchText]=window.setTimeout(function(){for(var o=[],c=0;c<r.length;c++)o=o.concat(r[c]);t.products=o,E.sendActivity(e,"viewSearch",t),Q[t.searchText]=[];var n=y();n.push({searchText:t.searchText,refinements:t.refinements,cookieId:t.cookieId,userId:t.userId,products:t.products}),i(n,"viewSearch","__cqsviews",e)},0)}function k(e,t){var r=t.categoryId,o=W[r]=W[r]||[];o.push(t.products),clearTimeout(G[r]),G[r]=window.setTimeout(function(){for(var c=[],n=0;n<o.length;n++)c=c.concat(o[n]);t.products=c,E.sendActivity(e,"viewCategory",t),W[r]=[];var a=_();a.push({refinements:t.refinements,categoryId:t.categoryId,cookieId:t.cookieId,userId:t.userId,products:t.products}),i(a,"viewCategory","__cqcviews",e)},0)}function S(e,t){for(var r=0;r<H.length;r++)for(var o=H[r].products,c=0;c<o.length;c++)if(o[c].id===t.id){var n={recommenderName:H[r].recommenderName,product:t,cookieId:H[r].cookieId,userId:H[r].userId,anchors:z[H[r].recommenderName]};return void E.sendActivity(e,"_clickReco",n)}}function b(e,t){for(var r=0;r<Y.length;r++)for(var o=Y[r].products,c=0;c<o.length;c++)if(o[c].id===t.id){var n={searchText:Y[r].searchText,refinements:Y[r].refinements,product:t,cookieId:Y[r].cookieId,userId:Y[r].userId};return void E.sendActivity(e,"clickSearch",n)}}function q(){try{return window.localStorage.setItem("cq","cq"),window.localStorage.removeItem("cq"),!0}catch(e){return!1}}function O(e,t){for(var r=0;r<Z.length;r++)for(var o=Z[r].products,c=0;c<o.length;c++)if(o[c].id===t.id){var n={refinements:Z[r].refinements,product:t,categoryId:Z[r].categoryId,cookieId:Z[r].cookieId,userId:Z[r].userId};return void E.sendActivity(e,"clickCategory",n)}}function T(){return!!(E.activities&&E.activities.length>0)||!!p("__cqact")}function x(e,t){if(e){var r=v(),o=t.map(function(e){return e.id});r[e]=o;var c=JSON.stringify(r);try{window.sessionStorage.setItem("cq.anchor",c)}catch(e){n("__cq_anchor",{value:c,domain:f("__cq_anchor"),path:"/"})}}}function N(e,t,r,o){var c={clientId:e,activityType:t,params:r,callback:o};D.push(c)}function C(){for(var e=0,t=D.length;e<t;e++){var r=D[e];E.sendActivity(r.clientId,r.activityType,r.params,r.callback)}D=[]}function j(){return!!p("__cq_uuid")}function R(){if(E.clientId)try{var e=p("__cqact");if(!e)return void window.setTimeout(R,100);var t=JSON.parse(e);if(!t[0])return l("__cqact"),void window.setTimeout(R,100);E.sendActivity(E.clientId,t[0].activityType,t[0].parameters,function(){J(t[0])})}catch(e){E.sendActivity(E.clientId,"error",{time:(new Date).getTime(),caughtError:e}),l("__cqact")}}function J(e){try{var t=p("__cqact");if(!t)return void R();for(var r=JSON.stringify(e.parameters.product||e.parameters.products),o=JSON.parse(t),c=f("__cqact"),i=0,a=o.length;i<a;i++)if(o[i].activityType===e.activityType&&JSON.stringify(o[i].parameters.product||o[i].parameters.products)===r){if(o.splice(i,1),n("__cqact",{value:JSON.stringify(o),domain:c,path:"/"}),JSON.parse(p("__cqact")).length===a)throw new Error("error deleting activity cookie");break}R()}catch(e){E.sendActivity(E.clientId,"error",{time:(new Date).getTime(),caughtError:e}),l("__cqact")}}function A(e){e=e.toLowerCase();for(var t=0;t<te.length;t++){var r=te[t];if(e.indexOf(r)>=0)return r}return"other"}var E=e.CQuotient=window.CQuotient||(e.CQuotient={});E.VERSION="v2.9.16";var U=0,D=[],P=!0,M=!1;E.byteLength=function(e){for(var t=e.length,r=0,o=e.length;r<o;r++){var c=e.charCodeAt(r);c>127&&c<=2047?t++:c>2047&&c<=65535&&(t+=2),c>=55296&&c<=56319&&r++}return t},E._getTopDomain=function(e){var t,r,o="weird_get_top_level_domain=cookie",c=e.split(".");for(t=c.length-1;t>=0;t--)if(r=c.slice(t).join("."),document.cookie=o+";domain=."+r+";",document.cookie.indexOf(o)>-1)return document.cookie=o.split("=")[0]+"=;domain=."+r+";expires=Thu, 01 Jan 1970 00:00:01 GMT;","."+r;return!1};var F=E._getTopDomain(document.location.hostname),B={customerSignup:["cookieId","userId","emailId"],viewPage:["cookieId","pageId"],viewProduct:["cookieId","product"],search:["cookieId","searchText"],viewSearch:["cookieId","searchText","products"],clickSearch:["cookieId","searchText","product"],viewCategory:["cookieId","categoryId"],clickCategory:["cookieId","categoryId"],viewCart:["cookieId","products"],addToCart:["cookieId","product"],removeFromCart:["cookieId","product"],beginCheckout:["cookieId","products","amount"],finishCheckout:["cookieId","products","amount"],reviewProduct:["cookieId","product","rating"],clickReco:["cookieId","product"],_clickReco:["cookieId","product"],viewWishList:["cookieId"],addToWishList:["cookieId"],removeFromWishList:["cookieId"],viewReco:["cookieId"],servedReco:[],error:[]},L={},V={},Q={},$={},W={},G={},H=g();try{window.sessionStorage.removeItem("cq.viewReco")}catch(e){document.cookie="__cqviews=;path=/;"}var Y=y();try{window.sessionStorage.removeItem("cq.viewSearch")}catch(e){document.cookie="__cqsviews=;path=/;"}var Z=_();try{window.sessionStorage.removeItem("cq.viewCategory")}catch(e){document.cookie="__cqcviews=;path=/;"}var z=v();try{window.sessionStorage.removeItem("cq.anchor")}catch(e){l("__cq_anchor")}var K=!1;if(window.setTimeout(function(){K||!E.clientId||T()||E.sendActivity(E.clientId,"viewPage",{cookieId:p("cqcid")})},1e3),E.sendActivity=function(e,r,o,c){function n(){delete E[T],R.parentNode.removeChild(R)}if(a())return u(),new Image;if(!e)throw new Error("Must provide a clientId");if(!B.hasOwnProperty(r))throw new Error("Unsupported activity type!");if(K=!0,o=o||{},"viewReco"===r){if(o.accumulate)return delete o.accumulate,void w(e,o);var i=v(),f=o.recommenderName;i.hasOwnProperty(f)&&(o.anchors=i[f])}if("viewSearch"===r&&o.accumulate)return delete o.accumulate,void I(e,o);if("viewCategory"===r&&o.accumulate)return delete o.accumulate,void k(e,o);if("viewProduct"===r&&(S(e,o.product),b(e,o.product),O(e,o.product)),!("clickReco"===r&&H.length>0)){var l=s("__cq_eid");l&&(o.emailId=l),"_clickReco"===r&&(r="clickReco"),o.referrer=window.document.referrer;var h=p("__cq_uuid");h&&(o.__cq_uuid=h);var g=p("__cq_seg");g&&(o.__cq_seg=g);var y="https://p."+t()+"/pebble?tla="+e+"&activityType="+r,_=m(e);_&&(o.bc=_),o.ls=q(),y+="&_="+(new Date).getTime();var T="_act_callback"+U++;y+="&callback=CQuotient."+T,o.v=E.VERSION;var x=d(o);if(x.length>0&&(y+="&"+x),!j()&&!M){if(!P)return void N(e,r,o,c);P=!1}var R=document.createElement("script");return R.src=y,R.type="text/javascript",E[T]=function(e){if("[object Object]"===Object.prototype.toString.call(e)&&(e=[e]),"[object Array]"===Object.prototype.toString.call(e))for(var t=0,r=e.length;t<r;t++)document.cookie=e[t].k+"="+e[t].v+";path=/;domain="+(F||e[t].d)+";max-age="+e[t].m;j()||(M=!0),C(),n(),c&&c()},document.getElementsByTagName("body")[0].appendChild(R),new Image}},E.clientId&&E.activities&&E.activities.length>0){for(var X=0;X<E.activities.length;X++){var ee=E.activities[X];E.sendActivity(E.clientId,ee.activityType,ee.parameters)}E.activities=[]}R();var te=["ipad","iphone","android","windows","mac"],re={pdp:!0,topsellers:!0,v2v:!0};if(E.getRecs=function(e,r,o,c,n){function i(){delete E[h],I.parentNode.removeChild(I),window.clearTimeout(k)}var a=new Date;if(!e)return void(n&&n({errorMessage:'Invalid value for "clientId":'+e}));if(!r)return void(n&&n({errorMessage:'Invalid value for "recommenderName":'+r}));o=o||{};var u=p("__cq_uuid");u&&(o.__cq_uuid=u);var s=!1;for(var f in re)re.hasOwnProperty(f)&&r.indexOf(f)>=0&&(s=re[f]);var l,v=o.timeoutMs||5e3,h="_callback"+U++,g="recs/"+e+"/"+r+"?callback=CQuotient."+h;if(s?l="r":(g+="&_="+(new Date).getTime(),l="e"),o.filters){var y=o.filters;delete o.filters,y.fieldsToMatchToValue&&(o.filter_fieldsToMatchToValue=y.fieldsToMatchToValue)}r&&o.hasOwnProperty("anchors")&&x(r,o.anchors),o.v=E.VERSION,g+="&_device="+A(navigator.userAgent);var _=m(e);_&&(o.bc=_);var w=d(o);w.length>0&&(g+="&"+w);var I=document.createElement("script");I.src="https://"+l+"."+t()+"/"+g,I.type="text/javascript";var k=window.setTimeout(function(){try{n&&n({errorMessage:"Reco request timed out for recommender: "+r})}finally{i()}},v);E[h]=function(t){try{if("[object Object]"===Object.prototype.toString.call(t))try{c(t)}catch(r){E.sendActivity(e,"error",{time:new Date-a,recoRequestParams:o,recoResponse:t,caughtError:r})}finally{E.sendActivity(e,"servedReco",{time:new Date-a,recoRequestParams:o,recoResponse:t})}else if(n)try{n(t)}finally{E.sendActivity(e,"error",{time:new Date-a,recoRequestParams:o,recoResponse:t})}}catch(r){E.sendActivity(e,"error",{time:new Date-a,recoRequestParams:o,recoResponse:t,caughtError:r})}finally{i()}},document.getElementsByTagName("body")[0].appendChild(I)},E.clientId&&E.widgets&&E.widgets.length>0){for(var oe=0;oe<E.widgets.length;oe++){var ce=E.widgets[oe];E.getRecs(E.clientId,ce.recommenderName,ce.parameters,ce.callback,ce.errorCallback)}E.widgets=[]}}("undefined"!=typeof module&&module.exports?exports:window);
